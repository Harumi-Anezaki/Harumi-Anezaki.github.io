<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVG Viewer & HTML Merger</title>
    <!-- Tailwind CSSã¨Google Fontsã®èª­ã¿è¾¼ã¿ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body, html {
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #f0f2f5; /* èƒŒæ™¯è‰² */
        }
        #container {
            width: 100%;
            height: 100%;
            overflow: auto;
            touch-action: none; 
        }
        #contentWrapper {
            transform-origin: 0 0;
            user-select: text;
            position: relative;
        }
        #fileInput {
            display: none;
        }
        /* ãƒ¢ãƒ¼ãƒ€ãƒ«å†…ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã‚¹ã‚¿ã‚¤ãƒ« */
        .modal-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .modal-scrollbar::-webkit-scrollbar-track {
            background: #2d3748; /* bg-gray-800 */
        }
        .modal-scrollbar::-webkit-scrollbar-thumb {
            background: #4a5568; /* bg-gray-600 */
            border-radius: 4px;
        }
        .modal-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #718096; /* bg-gray-500 */
        }
    </style>
</head>
<body class="antialiased">

    <!-- === SVG Zoom App UI === -->
    <input type="file" id="fileInput" accept=".html, .svg" />
    <div id="container">
        <div id="contentWrapper">
             <div class="p-8 text-gray-500 text-center">
                <h2 class="text-2xl font-bold mb-4">SVG/HTMLãƒ“ãƒ¥ãƒ¼ã‚¢</h2>
                <p>å·¦ä¸‹ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚¢ã‚¤ã‚³ãƒ³ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦è¡¨ç¤ºã—ã¾ã™ã€‚</p>
            </div>
        </div>
    </div>
    <div id="zoomControls" class="fixed bottom-8 right-8 flex flex-col items-center gap-3">
        <!-- æ–°è¦: HTML Mergerã‚’é–‹ããƒœã‚¿ãƒ³ -->
        <button id="openMergerBtn" title="HTMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’çµåˆ"
                class="w-14 h-14 bg-gradient-to-br from-purple-500 to-indigo-600 text-white rounded-full shadow-lg transform transition-all duration-200 ease-in-out hover:scale-110 hover:shadow-xl active:scale-100 flex items-center justify-center">
             <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
            </svg>
        </button>
        <!-- ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒœã‚¿ãƒ³ -->
        <label for="fileInput" id="fileLabel" title="ãƒ“ãƒ¥ãƒ¼ã‚¢ã§é–‹ã"
               class="flex items-center justify-center w-14 h-14 bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-full shadow-lg cursor-pointer transform transition-all duration-200 ease-in-out hover:scale-110 hover:shadow-xl active:scale-100">
            <span class="text-3xl">ğŸ“</span>
        </label>
        <button id="resetBtn" title="ãƒªã‚»ãƒƒãƒˆ" class="w-12 h-12 bg-gradient-to-br from-gray-500 to-gray-600 text-white text-2xl font-bold rounded-full shadow-lg transform transition-all duration-200 ease-in-out hover:scale-110 hover:shadow-xl active:scale-100">â†º</button>
        <button id="zoomOutBtn" title="ç¸®å°" class="w-12 h-12 bg-gradient-to-br from-gray-500 to-gray-600 text-white text-3xl rounded-full shadow-lg transform transition-all duration-200 ease-in-out hover:scale-110 hover:shadow-xl active:scale-100 flex items-center justify-center pb-1">-</button>
        <button id="zoomInBtn" title="æ‹¡å¤§" class="w-12 h-12 bg-gradient-to-br from-gray-500 to-gray-600 text-white text-3xl rounded-full shadow-lg transform transition-all duration-200 ease-in-out hover:scale-110 hover:shadow-xl active:scale-100 flex items-center justify-center pb-1">+</button>
    </div>

    <!-- === HTML File Merger Modal === -->
    <div id="merger-modal" class="hidden fixed inset-0 bg-gray-900/80 backdrop-blur-sm flex items-center justify-center p-4 z-50 transition-opacity duration-300">
        <div class="w-full max-w-2xl mx-auto bg-gray-800/70 backdrop-blur-xl border border-gray-700 rounded-2xl shadow-2xl p-8 md:p-10 transform transition-all duration-500 relative">
            <!-- é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ -->
            <button id="close-modal-button" class="absolute top-4 right-4 text-gray-400 hover:text-white transition-colors duration-200">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
            <div class="text-center mb-8">
                <h1 class="text-3xl md:text-4xl font-bold text-white mb-3">HTML File Merger</h1>
                <p class="text-gray-400">è¤‡æ•°ã®HTMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¹ãƒãƒ¼ãƒˆã«çµåˆã—ã¾ã™ã€‚</p>
            </div>
            <div class="space-y-6">
                <div>
                    <label for="file-upload" class="cursor-pointer w-full group inline-flex items-center justify-center px-6 py-3.5 border-2 border-dashed border-gray-600 hover:border-cyan-500 text-base font-medium rounded-lg text-gray-400 hover:text-white bg-gray-800 hover:bg-cyan-500/10 transition-all duration-300">
                        <svg class="w-6 h-6 mr-3 text-gray-500 group-hover:text-cyan-400 transition-all duration-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 16.5V9.75m0 0l-3.75 3.75M12 9.75l3.75 3.75M3 17.25V6.75A2.25 2.25 0 015.25 4.5h13.5A2.25 2.25 0 0121 6.75v10.5A2.25 2.25 0 0118.75 19.5H5.25A2.25 2.25 0 013 17.25z" /></svg>
                        ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ (è¤‡æ•°å¯)
                    </label>
                    <input id="file-upload" type="file" class="sr-only" accept=".html, .htm" multiple>
                </div>
                <div class="flex items-center justify-center pt-2">
                    <label for="remove-scripts-checkbox" class="flex items-center cursor-pointer"><div class="relative"><input id="remove-scripts-checkbox" type="checkbox" class="sr-only peer"><div class="w-10 h-6 bg-gray-700 rounded-full shadow-inner peer-checked:bg-cyan-500 transition-all duration-300"></div><div class="absolute left-1 top-1 w-4 h-4 bg-white rounded-full transition-all duration-300 peer-checked:translate-x-full"></div></div><span class="ml-3 text-sm font-medium text-gray-300">ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚°ã‚’å‰Šé™¤ã™ã‚‹</span></label>
                </div>
                <div class="flex justify-center !mt-8">
                     <button id="merge-button" class="w-full sm:w-auto inline-flex items-center justify-center px-8 py-3.5 border border-transparent text-base font-bold rounded-lg shadow-lg text-white bg-cyan-600 hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-cyan-500 transition-all duration-300 transform hover:scale-105 disabled:bg-gray-600 disabled:cursor-not-allowed disabled:transform-none" disabled>
                        <svg class="w-5 h-5 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" /></svg>
                        çµåˆã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                    </button>
                </div>
            </div>
            <div id="file-list-container" class="mt-8 space-y-3 hidden">
                <h3 class="text-base font-semibold text-gray-400 text-center tracking-wider">é¸æŠã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«</h3>
                <ul id="file-list" class="space-y-2 bg-gray-900/50 p-4 rounded-lg border border-gray-700 max-h-48 overflow-y-auto modal-scrollbar"></ul>
            </div>
            <div id="message-box" class="hidden mt-6 p-4 text-center text-sm font-medium rounded-lg"></div>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // === ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªDOMè¦ç´ ï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«åˆ¶å¾¡ç”¨ï¼‰ ===
            const openMergerBtn = document.getElementById('openMergerBtn');
            const mergerModal = document.getElementById('merger-modal');
            const closeModalBtn = document.getElementById('close-modal-button');

            // --- ãƒ¢ãƒ¼ãƒ€ãƒ«åˆ¶å¾¡ãƒ­ã‚¸ãƒƒã‚¯ ---
            function openModal() {
                mergerModal.classList.remove('hidden');
            }
            function closeModal() {
                mergerModal.classList.add('hidden');
            }
            openMergerBtn.addEventListener('click', openModal);
            closeModalBtn.addEventListener('click', closeModal);
            mergerModal.addEventListener('click', (e) => {
                if (e.target === mergerModal) closeModal();
            });
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && !mergerModal.classList.contains('hidden')) {
                    closeModal();
                }
            });


            // --- SVG Zoom App ãƒ­ã‚¸ãƒƒã‚¯ ---
            (() => {
                const fileInput = document.getElementById('fileInput');
                const contentWrapper = document.getElementById('contentWrapper');
                const container = document.getElementById('container');
                const zoomInBtn = document.getElementById('zoomInBtn');
                const zoomOutBtn = document.getElementById('zoomOutBtn');
                const resetBtn = document.getElementById('resetBtn');

                let scale = 1;
                let translateX = 0;
                let translateY = 0;
                let isPanning = false;
                let startX = 0;
                let startY = 0;

                fileInput.addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (!file) return;
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        contentWrapper.innerHTML = event.target.result;
                        if (contentWrapper.firstElementChild) {
                            contentWrapper.firstElementChild.style.width = '100%';
                        }
                    };
                    reader.readAsText(file);
                });

                zoomInBtn.addEventListener('click', () => zoom(1.4, container.clientWidth / 2, container.clientHeight / 2));
                zoomOutBtn.addEventListener('click', () => zoom(1 / 1.4, container.clientWidth / 2, container.clientHeight / 2));
                resetBtn.addEventListener('click', () => {
                    scale = 1;
                    translateX = 0;
                    translateY = 0;
                    updateTransform();
                });

                function zoom(factor, centerX, centerY) {
                    const rect = contentWrapper.getBoundingClientRect();
                    const dx = centerX - rect.left;
                    const dy = centerY - rect.top;
                    scale *= factor;
                    translateX -= dx * (factor - 1);
                    translateY -= dy * (factor - 1);
                    updateTransform();
                }

                function updateTransform() {
                    contentWrapper.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
                }

                container.addEventListener('wheel', (e) => {
                    e.preventDefault();
                    if (e.ctrlKey) {
                        const factor = e.deltaY < 0 ? 1.4 : 1 / 1.4;
                        zoom(factor, e.clientX, e.clientY);
                    } else {
                        translateY -= e.deltaY;
                        translateX -= e.deltaX;
                        updateTransform();
                    }
                }, { passive: false });

                container.addEventListener('pointerdown', (e) => {
                    if (e.isPrimary && e.button === 0) {
                        isPanning = true;
                        startX = e.clientX - translateX;
                        startY = e.clientY - translateY;
                        container.style.cursor = 'grabbing';
                    }
                });

                container.addEventListener('pointermove', (e) => {
                    if (isPanning) {
                        translateX = e.clientX - startX;
                        translateY = e.clientY - startY;
                        updateTransform();
                    }
                });

                const stopPanning = () => {
                    isPanning = false;
                    container.style.cursor = 'default';
                };
                container.addEventListener('pointerup', stopPanning);
                container.addEventListener('pointerleave', stopPanning);
            })();


            // --- HTML File Merger ãƒ­ã‚¸ãƒƒã‚¯ ---
            (() => {
                const fileUpload = document.getElementById('file-upload');
                const mergeButton = document.getElementById('merge-button');
                const removeScriptsCheckbox = document.getElementById('remove-scripts-checkbox');
                const fileListContainer = document.getElementById('file-list-container');
                const fileList = document.getElementById('file-list');
                const messageBox = document.getElementById('message-box');
                const fileListEntryTemplate = (fileName) => `
                    <li class="flex items-center text-gray-300 bg-gray-800/60 p-2.5 rounded-md text-sm border-l-4 border-gray-600">
                        <svg class="w-5 h-5 mr-3 text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm.293 8.293a1 1 0 011.414 0L8 13.586l2.293-2.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                        <span class="truncate">${fileName}</span>
                    </li>`;

                let selectedFiles = [];

                function showMessage(message, type = 'info') {
                    messageBox.textContent = message;
                    messageBox.className = 'mt-6 p-4 text-center text-sm font-medium rounded-lg';
                    messageBox.classList.remove('hidden');
                    
                    if (type === 'success') messageBox.classList.add('bg-emerald-500/10', 'text-emerald-300', 'border', 'border-emerald-500/20');
                    else if (type === 'error') messageBox.classList.add('bg-red-500/10', 'text-red-300', 'border', 'border-red-500/20');
                    else messageBox.classList.add('bg-sky-500/10', 'text-sky-300', 'border', 'border-sky-500/20');
                }

                fileUpload.addEventListener('change', (event) => {
                    selectedFiles = Array.from(event.target.files);
                    messageBox.classList.add('hidden');
                    const htmlFiles = selectedFiles.filter(file => file.type.match('text/html'));
                    
                    if (htmlFiles.length > 0) {
                        fileList.innerHTML = htmlFiles.map(file => fileListEntryTemplate(file.name)).join('');
                        fileListContainer.classList.remove('hidden');
                    } else {
                        fileListContainer.classList.add('hidden');
                    }
                    mergeButton.disabled = htmlFiles.length < 2;
                    if (selectedFiles.length > 0 && selectedFiles.length !== htmlFiles.length) {
                        showMessage('HTMLä»¥å¤–ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ç„¡è¦–ã•ã‚Œã¾ã™ã€‚', 'info');
                    }
                });

                mergeButton.addEventListener('click', async () => {
                    const htmlFiles = selectedFiles.filter(file => file.type.match('text/html'));
                    if (htmlFiles.length < 2) {
                        showMessage('çµåˆã™ã‚‹ã«ã¯ã€2ã¤ä»¥ä¸Šã®HTMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚', 'error');
                        return;
                    }
                    mergeButton.disabled = true;
                    mergeButton.innerHTML = `<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>çµåˆä¸­...`;
                    
                    const shouldRemoveScripts = removeScriptsCheckbox.checked;
                    const fileReadPromises = htmlFiles.map(file => new Promise((resolve, reject) => {
                        const reader = new FileReader();
                        reader.onload = (e) => resolve(e.target.result);
                        reader.onerror = (e) => reject(e);
                        reader.readAsText(file, 'UTF-8');
                    }));

                    try {
                        const filesContent = await Promise.all(fileReadPromises);
                        const mergedContent = filesContent.map(content => {
                            return shouldRemoveScripts ? content.replace(/<script\b[^>]*>[\s\S]*?<\/script>/gi, '') : content;
                        }).join('\n\n<!-- File Separator -->\n\n');
                        
                        downloadFile(mergedContent, 'merged.html', 'text/html');
                        let successMessage = `${htmlFiles.length}å€‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’çµåˆã—ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹ã—ã¾ã—ãŸã€‚`;
                        if(shouldRemoveScripts) successMessage += ' (ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚°å‰Šé™¤æ¸ˆã¿)';
                        showMessage(successMessage, 'success');
                    } catch (error) {
                        showMessage('ãƒ•ã‚¡ã‚¤ãƒ«ã®çµåˆä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚', 'error');
                    } finally {
                        mergeButton.disabled = htmlFiles.length < 2;
                        mergeButton.innerHTML = `<svg class="w-5 h-5 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" /></svg>çµåˆã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰`;
                    }
                });

                function downloadFile(content, fileName, contentType) {
                    const blob = new Blob([content], { type: contentType });
                    const a = document.createElement('a');
                    a.href = URL.createObjectURL(blob);
                    a.download = fileName;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(a.href);
                }
            })();
        });
    </script>
</body>
</html>